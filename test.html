<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="田桓实业">
    <title>田桓实业</title>
    <link rel="stylesheet" href="../static/css/main.css"/>
</head>
<body>
<div style="width: 300px; margin: 100px auto; background-color: #333;">
    <img id="myHammer" src="../static/images/exhibition/1.jpg" width="300" style="transform: scale(1.33131)"/>
</div>
<div class="console" style="position: fixed; right: 0; bottom: 0; width: 100%; height: 30px;"></div>
<div class="console3" style="position: fixed; right: 0; bottom: 30px; width: 100%; height: 30px;"></div>
<script src="../static/js/jquery-1.11.3.min.js"></script>
<script src="../static/js/hammer.min.js"></script>
<script>
    var el = document.getElementById('myHammer'),
        myHammer = new Hammer(el),
        getScale = function(el){
            var str = $(el).css('transform');

            if(str === 'none'){
                return 1;
            } else {
                // 小数点保留两位
                return +parseFloat($(el).css('transform').match(/\d.*\d/)[0].split(',')[0]).toFixed(3);
            }
        },
        getTranslate = function(el){
            var str = $(el).css('transform'),
                arr,
                scale = getScale(el);

            if(str === 'none'){
                return {
                    x: 0,
                    y: 0
                };
            } else {
                arr = $(el).css('transform').match(/\d.*\d/);
                // 小数点保留两位
                return {
                    x: +parseFloat(arr[0].split(',')[4]  / scale).toFixed(3),
                    y: +parseFloat(arr[0].split(',')[5] / scale).toFixed(3)
                };
            }
        };


    var startScale = getScale(el);
    myHammer.get('pinch').set({enable: true});
    myHammer.on('pinch', function (ev) {
        var endScale = startScale + (parseFloat(ev.scale).toFixed(3) - 1);

        $('.console').html(startScale);
        endScale = endScale < 1 ? 1 : endScale;
        endScale = endScale >3 ? 3 : endScale;

        $(el).css('transform', 'scale(' + endScale + ')');
    });

    $(el).bind('touchstart', function(){
        startScale = getScale(el);
    });
</script>
</body>
</html>